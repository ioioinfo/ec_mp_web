<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
    <meta name="format-detection" content="telephone=no" />
    <title>新闻中心</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/jinping.css">
    <script src="js/jquery-3.1.1.min.js"></script>
    <script src="js/react.min.js"></script>
    <script src="js/react-dom.min.js"></script>
    <script src="js/browser.min.js"></script>
    <script src="js/jinzhi.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <style media="screen">
    .top{
     width: 100%;
     height: 47px;
     overflow: hidden;
     border-bottom: 1px solid #e7e7e7;
     box-shadow: 0 2px 5px #e7e7e7;
     background: #fff;
     margin-bottom: 20px;
   }
   .top .back{
     width: 12.5333333%;
     height: 47px;
     float: left;
     display: inline-block;
     text-align: center;
     line-height: 47px;

   }
   .top .back img{
     width: 20px;
     height: 20px;
     vertical-align: middle;
   }
   .top .top-right{
     width: 12.5333333%;
     height: 47px;
     float: right;
     display: inline-block;
     text-align: center;
     line-height: 47px;
     position: relative;
   }
   .top .top-right p{
     display: inline-block;
     width: 14px;
     height: 14px;
     line-height: 14px;
     color: #fff;
     position: absolute;
     left: 25px;
     top: 11px;
     font-size: 12px;
     background: #D81E06;
     border-radius: 50%;
     text-align: center;
     display: none;
   }
   .top .top-right img{
     width: 20px;
     height: 20px;
     vertical-align: middle;
   }
   .top .top-title{
     float: left;
     width: 74.93333333%;
     height: 47px;
     line-height: 47px;
     text-align: center;
     color: #333;
   }
   .newsimg{
     display: inline-block;
     width: 14.444%;
     height: 48px;
   }
   .newsimg img{
     width: 100%;
     height: 48px;
   }
   .newsword{
     display: inline-block;
     width: 82%;
     vertical-align: top;
     padding-left: 10px;
     font-size: 12px;
     line-height: 20px;
     height: 41px;
     overflow:hidden;
     text-overflow:ellipsis;
   }
    }
    </style>
  </head>
  <body>
    <div id="example"></div>
    <script type="text/babel">
    class Wrap extends React.Component {
      render() {
          return (
            <div className="wrap">
              <Header/>
              <Middle/>
            </div>
          );
      }
    };
    // 头部
    class Header extends React.Component {
      render() {
          return (
              <div className="top">
                <div className="back">
                  <a href="person_center"><img src="images/back.png" alt="" /></a>
                </div>
                <p className="top-title">新闻</p>
                <div className="top-right"><a href="/messages"><img src="images/news.png" alt="" /><p className="headernewsnum"></p></a></div>
              </div>
          );
      }
    };
    // 中间部分
    class Middle extends React.Component {
        constructor(props) {
          super(props);
          this.state={newsitem:[]};
        }
        componentDidMount() {
            $.ajax({
                 url: "/published_announce",
                 dataType: 'json',
                 type: 'GET',
                 success: function(data) {
                    this.setState({newsitem:data.rows});
                 }.bind(this),
                 error: function(xhr, status, err) {
                 }.bind(this)
            });
        }
      render() {
          return (
            <div className="middle">
              {this.state.newsitem.map(item => (
                  <News item={item}/>))
              }
            </div>
          );
      }
    };
    // 中间消息
    class News extends React.Component {
      render() {
          var p = "";
          var imgLength = this.props.item.imgs.length;
          var img = "images/" + this.props.item.imgs[0];
          if(imgLength ==0){
              p = <p className="newsimg"><img src="images/icon.png" alt="" /></p>;
          }else {
              p =  <p className="newsimg"><img src={img} alt="" /></p>;
          }
          return (
            <div className="news">
              <div className="newsInfor">
                <p className="newsTitle">{this.props.item.title}</p>
                <div className="newscontent">
                  {p}
                  <p className="newsword">{this.props.item.pub_date}</p>
                </div>
              </div>
            </div>
          );
      }
    };

      // 返回到页面
      ReactDOM.render(
        <Wrap/>,
        document.getElementById("example")
      );
    </script>
  </body>
</html>
