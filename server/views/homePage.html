<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
    <meta name="format-detection" content="telephone=no" />
    <title>首页</title>
    <script src="js/react.min.js"></script>
    <script src="js/react-dom.min.js"></script>
    <script src="js/browser.min.js"></script>
	<script src="js/jquery-3.1.1.min.js"type="text/javascript"></script>
    <style media="screen">
      @media screen and (max-width:640px){
      *{
          padding: 0;
          margin: 0;
        }
        html,body{
          margin: 0;
          padding: 0;
          width: 100%;
          height: 100%;
          position: relative;
        }
        a{
          text-decoration: none;
          color: #999;
        }
        /*头部搜索框*/
      .header{
          width: 100%;
          /*height: 146px;*/
          overflow: hidden;
        }
        .search{
          width: 100%;
          height:36px;
          line-height: 36px;
          background: rgb(112,180,44);
          text-align: center;
          position: relative;
          overflow: hidden;
        }

        .searchfangdaImg{
          position: absolute;
          top: 10px;
          left: 4.26829268%;
        }
        input::-webkit-input-placeholder {
          color:    #fff;
        }
        input:-moz-placeholder {
          color:    #fff;
        }
        input::-webkit-input-results {
          color:    #fff;
        }
        input:-moz-results {
          color:    #fff;
        }
        .headersearch{
          display: inline-block;
          width: 87.4666666%;
          height: 25px;
          line-height: 25px;
          outline-style: none;
          border: none;
          border-radius: 6px;
          text-indent: 26px;
        }
        .headernews{
          display: inline-block;
          width: 6.6666%;
          height: 25px;
          position: relative;
        }
        .headernewsnum{
          position: absolute;
          top: 6px;
          left: 17px;
          font-size: 12px;
          font-weight: 400;
          color: #EE0A08;
          background: #fff;
          width: 14px;
          height: 14px;
          line-height: 14px;
          border-radius: 7px;
        }
        .headernimg{
          vertical-align: middle;
          margin-left: 5px;
		  width: 20px;
		  height: 20px;
        }


        /*轮播*/
		.lunbo{
            width: 375px;
            height: 117px;
            overflow: hidden;
            position: relative;
          }
		  .lunbo_ul{
            /*width: 1500px;*/
            box-sizing: border-box;
            overflow: hidden;
            border: none;
          }
		  .lunbo_ul_one{
            position: absolute;
            left: 0;
            top: 0;
          }
		  .lunbo_ul_two{
           position: absolute;
           /*left: -1500px;*/
           top: 0;
          }
		  .lunbo li{
            width: 375px;
            height: 117px;
            list-style: none;
            float: left;
          }
		  .lunbo li img{
            width: 375px;
            height: 117px;
          }
		  .lunbo_dian{
            width: 100%;
            text-align: center;
            position: absolute;
            bottom: 8px;
            left: 0;
          }
		  .lunbo_dian span{
			 display: inline-block;
			 width: 8px;
		 	 height: 8px;
			 border-radius: 50%;
			 border: 1px solid #3DB21F;
			 margin: 0 4px;

		   }
		   .lunbo_dian span.on{
			 background: #fff;

		   }

      /*中间部分*/
      .shouyemainimg{
        width: 100%;

      }
      /*底部导航*/
      .footernav{
        width: 100%;
        height: 42px;
        display: flex;
        padding-top: 5px;
        padding-bottom: 5px;
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: #fff;
        border-top: 1px solid #eee;
      }
      .footernav li{
        width: 20%;
        height:42px;
        box-sizing: border-box;
        list-style: none;
        text-align: center;
        font-size: 14px;
		position: relative;
      }
	  .footerCenter{

	 }
	 .footernav .footerCenter img{
	   width: 44px;
	   height: 44px;
	   position: absolute;
	   top: -20px;
	   left: 20.66666%;
	 }
	 .footernav .footerCenternext{
	   width: 48px;
	   font-size: 16px;
	   position: absolute;
	   top: 22px;
	   left: 13%;
	   color: rgb(112,180,44);
	 }
	  .footernav li p{
		  height: 22px;
		  box-sizing: border-box;
	  }
      .footernav li p img{
        width: 22px;
        height: 22px;
      }
	  .footernav li:first-child a{
		  color: #d81e06;
		}
	  .background0{
	   width: 100%;
	   font-size: 12px;
	   height: 36px;
	   background: #fff;
	   line-height: 36px;
	   text-align: center;
	   color: #999;
	 }
      .background{
        width: 100%;
        height: 46px;
        background: #fff;
      }
	  /*中间导航*/
      .navUl{
        width: 96%;
        margin: 22px auto;
        display: flex;
        flex-wrap:wrap;
      }
      .navUl .homeNavli{
        width: 25%;
        list-style: none;
        text-align: center;
        font-size: 12px;
        color: #666;
        margin-bottom: 8px;
      }
      .navUl .homeNavli img{
        width: 45%;
      }
	  /*滚动新闻样式*/
      .HomeNews{
        width: 100%;
        font-size: 12px;
        height: 25px;
        overflow: hidden;
        text-align: center;
      }
      .HomeNews li{
        height: 25px;
        line-height: 25px;
      }

      /*猜你喜欢*/
      .homeLike{
        width: 100%;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-around;
      }
	  .homeLikeLi{
        width: 46.26666%;
        height: 260px;
        border: 1px solid #e1e4e5;
        margin-bottom: 8px;
        list-style: none;
      }
      .homeLikeLi img{
        width: 100%;
      }
      .likename{
        font-size: 12px;
        padding: 4px 8px;
        color: #666;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        font-weight: 400;
        line-height: 18.25px;
      }
      .likeprice{
        padding: 4px 8px;
        font-size: 12px;
        color: #998a81;
      }
      .likeprice span{
        font-size: 14px;
        color: #d3333b;
        margin-right: 8px;
      }
      .yourLike{
        line-height: 16px;
        color: #333;
        position: relative;
        margin: 16px 0 8px 0;
        z-index: 2;
        border-bottom: 0 none;
        text-align: center;
        font-size: 16px;
      }
      .yourLike span{
        margin: 0;
        padding: 0 15px;
        background: #fff;
        display: inline-block;
      }
      .yourLike::after{
        content: "";
        border-top: 1px solid #e1e4e5;
        width: 90%;
        margin-left: 5%;
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        z-index: -1;
      }
	  /*活动内容*/
	.activity_ul{
	  width: 100%;
	  display: flex;
	  flex-wrap: wrap;
	  justify-content: space-around;
	}
	.activity_li{
	  width: 46.26666%;
	  border: 1px solid #e1e4e5;
	  margin-bottom: 8px;
	  list-style: none;
	}
	.activity_li img{
	  width: 100%;
	}
	.activity_li p{
	  font-size: 12px;
	  padding: 4px 8px;
	  color: #666;
	  display: -webkit-box;
	  -webkit-line-clamp: 2;
	  -webkit-box-orient: vertical;
	  overflow: hidden;
	  font-weight: 400;
	  line-height: 18.25px;
	}
    }
    </style>
</head>
<body>
  <div id="example"></div>
  <script type="text/javascript">
	  function getLikeData(params,cb) {

		  $.get("/get_recommend_products",function(data){
			  if (data.success) {
			  		var products = data.products;
					cb({likeitems:products});
			  }else {
				  alert(data.messsage);
			  }
		  });
	  }
  </script>
  <script src="js/lunbo.min.js"></script>
  <script type="text/babel">
  // 框架
  class Warp extends React.Component {
    render() {
        return (
          <div className="wrap">
            <Header search_url="/search_area"/>
            <Main/>
            <Footer person_url="/person_center" logistics_url="" cart_url="/cart_infos" sort_url="/sort" order_url="/order_center"/>
			 <Background0/>
			<Background/>
          </div>
        );
    }
  };
  // 头部搜索框
  class Header extends React.Component {
	  constructor(props) {
	  	super(props);
	  	this.handleSearch = this.handleSearch.bind(this);
		this.handMessage_number = this.handMessage_number.bind(this);
		var items = [
          {id:1,img:'images/htad1.jpg'}
          ,{id:2,img:'images/htad2.jpg'}
          ,{id:3,img:'images/htad3.jpg'}
        ];
		this.state = {"check_message_url":"/check_message_number","message_number":0,items:items};
	  }

	  handMessage_number(e){
		  $.ajax({
  		   url: this.state.check_message_url,
  		   dataType: 'json',
  		   type: 'POST',
  		   success: function(data) {
  			   this.setState({message_number: data.count});
  		   }.bind(this),
  		   error: function(xhr, status, err) {
  		   }.bind(this)
  	   });
  	}

	  componentDidMount() {
	    this.handMessage_number();
	  }

	handleSearch(e){
		location.href = this.props.search_url;
	}

    render() {
		var headernewsnum = <span></span>;
		if (this.state.message_number != 0) {
			headernewsnum = <span className="headernewsnum">{this.state.message_number}</span>;
		}
        return (
          <div className="header">
            <div className="search">
              <input  type="search" value="" placeholder="搜索" className="headersearch" onClick ={this.handleSearch}/>
              <span className="searchfangda"><img src="images/fangdajing.png" alt="" className="searchfangdaImg" /></span>
              <div className="headernews">
				  <a href="/messages">
		            <img src="images/new2.png" alt="" className="headernimg" />
		            {headernewsnum}
				  </a>
              </div>
            </div>
            <Lunbo items={this.state.items} />
          </div>
        );
    }
  };

  // 中间部分
  class Main extends React.Component {
    render() {
        return (
			<div className="main">
             <HomeNav/>
			 <News/>
			 <Activity/>
             <Like/>

           </div>
        );
    }
  };
  // 首页导航
  class HomeNav extends React.Component {
    constructor(props) {
        super(props);

        this.state={navitems:[]};
    }
    componentDidMount() {
      var nav = [{img:"images/ht_sy_xp.jpg",name:"每日新品"},
                 {img:"images/ht_sy_qz.jpg",name:"裙装"},
                 {img:"images/ht_sy_my.jpg",name:"母婴童装"},
                 {img:"images/ht_sy_sp.jpg",name:"饰品"},
                 {img:"images/ht_sy_cj.jpg",name:"厨房用品"},
                 {img:"images/ht_sy_jj.jpg",name:"家具家纺"},
                 {img:"images/ht_sy_jz.jpg",name:"残障伙伴兼职"},
                 {img:"images/ht_sy_gy.jpg",name:"关于善淘"}];
                 this.setState({navitems:nav});
    }
    render() {
        return (
          <ul className="navUl">
          {this.state.navitems.map(item => (
              <HomeNavli item={item} />))
          }
          </ul>
        );
    }
  };
  class HomeNavli extends React.Component {
    render() {
        return (
            <li className="homeNavli"><a><img src={this.props.item.img} alt="" /><p>{this.props.item.name}</p></a></li>
        );
    }
  };
  // 滚动新闻
 class News extends React.Component {
   constructor(props) {
	   super(props);
	   this.scroll=this.scroll.bind(this);
	   this.state={newsitems:[]};
   }
   componentDidMount() {
	 var news = [{word:"善淘网实体店2017-03-25开业"},
				 {word:"善淘网最新一期招募又开始啦"},
				 {word:"现在满199，即可获得抽奖机会一次"},
				 {word:"新品上线啦，"}];
	 this.setState({newsitems:news});

	 setInterval(this.scroll,2800);
   }
   scroll(){
	 var liTop=$(".HomeNews li").first().css("margin-top");

	 var liparseInt=parseInt(liTop);
	 console.log(liparseInt);

	   if (liparseInt<-20){
		 var First=$(".HomeNews li").first();
		 First.detach().css("margin-top","").appendTo($(".HomeNews"));
	   }

	 $(".HomeNews li").first().animate({"margin-top":"-25px"},450);

   }
   render() {
	   return (
		   <ul className="HomeNews">
		   {this.state.newsitems.map(item => (
			   <NewsLi item={item}  />))
		   }
		   </ul>
	   );
   }
 };
 // activity活动
   class Activity extends React.Component {
     constructor(props) {
         super(props);
         this.state={activityitems:[]};
     }
     componentDidMount() {
       var act = [{acname:"善淘网实体店2017-03-25开业",img:"images/activity_1.jpg"},
                   {acname:"现在冲会员享特权啦",img:"images/activity_2.jpg"}];
       this.setState({activityitems:act});
     }
     render() {

         return (
           <div>
             <p className="yourLike"><span>最新活动</span></p>
             <ul className="activity_ul">
               {this.state.activityitems.map(item => (
                   <Activity_li item={item}  />))
               }
             </ul>
           </div>

         );
     }
   };
   class Activity_li extends React.Component {

     render() {

         return (
           <li className="activity_li"><img src={this.props.item.img} alt="" /><p>{this.props.item.acname}</p></li>
         );
     }
   };
 // 猜你喜欢内容
 class NewsLi extends React.Component {

   render() {

	   return (

		   <li className="newsLi"><a href="#"><u>{this.props.item.word}</u></a></li>
	   );
   }
 };
 // 猜你喜欢
 class Like extends React.Component {
   constructor(props) {
	   super(props);
	   this.state={likeitems:[]};
   }
   componentDidMount() {
	   getLikeData({},function(data) {
		 this.setState(data);
	   }.bind(this));
	 setInterval(this.scroll,2800);
   }
   render() {

	   return (
		 <div>
		   <p className="yourLike"><span>猜你喜欢</span></p>

		   <ul className="homeLike">
			 {this.state.likeitems.map(item => (
				 <LikeLi item={item}  />))
			 }
		   </ul>
		 </div>
	   );
   }
 };
 // 猜你喜欢
 class LikeLi extends React.Component {

   render() {
	   var img = "images/no_picture.png";
	   var src = "/product_show?product_id="+this.props.item.id;
	   if (this.props.item.img) {
		   img = "images/"+this.props.item.img.location;
	   }
	   return (
		   <li className="homeLikeLi"><a href={src}><img src={img} alt="" /><p className="likename">{this.props.item.product_name}</p><p className="likeprice">￥<span>{this.props.item.product_sale_price}</span></p></a></li>
	   );
   }
 };
  // 底部导航
  class Footer extends React.Component {
	  constructor(props) {
		super(props);
		this.handleSort = this.handleSort.bind(this);
		this.handleLogistics = this.handleLogistics.bind(this);
		this.handleCart = this.handleCart.bind(this);
		this.handlePerson = this.handlePerson.bind(this);
	  }
	  handleSort(e){
		  location.href = this.props.sort_url;
	  }
	  handleLogistics(e){
		  location.href = this.props.order_url;
	  }
	  handleCart(e){
		  location.href = this.props.cart_url;
	  }
	  handlePerson(e){
		  location.href = this.props.person_url;
	  }
    render() {
        return (
          <ul className="footernav">
            <li><a href="/"><p><img src="images/shouye2.png" alt="" /></p><p>首页</p></a></li>
			<li><a href="/sort"><p><img src="images/fenlei4.png" alt="" /></p><p>分类</p></a></li>
		  <li><a href="/news"><p className="footerCenter"><img src="images/shouyeshequ.png" alt="" /></p><p className="footerCenternext">EVENTS</p></a></li>
		  <li><a href="/cart_infos"><p><img src="images/gouwuche2.png" alt="" /></p><p>购物车</p></a></li>
            <li><a href="/person_center"><p><img src="images/wode.png" alt="" onClick={this.handlePerson}/></p><p>我的</p></a></li>
          </ul>
        );
    }
  };
  // 没有更多商品！！！
 class Background0 extends React.Component {
   render() {
	   return (
		 <div className="background0">没有更多商品！！！</div>
	   );
   }
 };
  // 底部空白
  class Background extends React.Component {
    render() {
        return (
          <div className="background"></div>
        );
    }
  };
    ReactDOM.render(
        <Warp />,
        document.getElementById('example')
    );
    </script>

</body>
</html>
